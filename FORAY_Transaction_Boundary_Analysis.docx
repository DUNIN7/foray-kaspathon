**FORAY Protocol**

Transaction Boundary Analysis

*Identifying Challenging Transaction Types and Protocol Limitations*

Version 1.0 \| January 30, 2026

  ----------------- -----------------------------------------------------
  **Property**      **Value**

  Document Version  1.0

  Created           2026-01-30T14:30:00Z

  Author            Marvin Percival

  Classification    Technical Analysis - Internal Review

  Protocol Version  FORAY v4.1
  ----------------- -----------------------------------------------------

Executive Summary

This document provides an honest assessment of business transaction
types that may present challenges for FORAY Protocol implementation.
While FORAY v4.1 successfully handles the vast majority of enterprise
transactions---including complex financial instruments, manufacturing
operations, and multi-party settlements---certain edge cases require
careful consideration.

Our analysis identifies 12 categories of potentially challenging
transactions, organized by severity. Importantly, none of these
represent fundamental protocol incompatibilities---all have functional
workarounds. This transparency serves two purposes: (1) to help
implementers anticipate complexity during integration, and (2) to inform
future protocol evolution.

Summary Assessment

  ----------------------- ----------- -----------------------------------
  **Severity Level**      **Count**   **Protocol Impact**

  **CRITICAL**            0           No transaction types are
                                      unsupported

  **HIGH**                3           Require architectural consideration

  **MEDIUM**              5           Functional workarounds available

  **LOW**                 4           Minor verbosity or philosophical
                                      differences
  ----------------------- ----------- -----------------------------------

Category 1: High-Severity Challenges

These transaction types require careful architectural planning and may
involve trade-offs between audit granularity and system performance.

1.1 High-Frequency Streaming Data (IoT/Telemetry)

  ----------------- -----------------------------------------------------
  **Severity**      **HIGH**

  **Examples**      IoT sensor readings (1,000+/second), manufacturing
                    telemetry, utility smart meters, real-time process
                    monitoring, continuous environmental sensors

  **Challenge**     FORAY anchors discrete transactions, not continuous
                    data streams. Individual sensor readings at high
                    frequency would overwhelm blockchain anchoring
                    capacity and create impractical storage requirements.

  **Workaround**    Batch measurements into periodic Accruals
                    (hourly/daily aggregates). The aggregation point
                    becomes the auditable transaction, with raw data
                    stored off-chain and referenced by hash.

  **Trade-off**     Loses individual reading granularity on-chain.
                    Auditors must trust the aggregation process or verify
                    against off-chain raw data archives.
  ----------------- -----------------------------------------------------

1.2 Probabilistic Matching Algorithms

  ----------------- -----------------------------------------------------
  **Severity**      **HIGH**

  **Examples**      Bank statement reconciliation (FF67 in SAP), ML-based
                    invoice matching, fuzzy duplicate detection, credit
                    scoring models, fraud detection algorithms

  **Challenge**     FORAY\'s deterministic model doesn\'t natively
                    express \"70% confidence this matches\" or
                    probabilistic scoring. The protocol records
                    definitive states, not confidence intervals.

  **Workaround**    Create multiple Anticipations with probability_factor
                    fields representing different matching candidates.
                    Record the selection decision as a separate Action
                    that references the chosen match.

  **Trade-off**     Probabilistic reasoning happens off-chain; only final
                    decisions are anchored. Auditors cannot replay the ML
                    inference process from FORAY data alone.
  ----------------- -----------------------------------------------------

1.3 Circular and Recursive Dependencies

  ----------------- -----------------------------------------------------
  **Severity**      **HIGH**

  **Examples**      Intercompany eliminations, reciprocal service
                    allocations, circular ownership structures, iterative
                    pricing models that reference their own outputs

  **Challenge**     FORAY\'s DAG (Directed Acyclic Graph) structure
                    explicitly prohibits circular references. Component B
                    cannot reference Component A if A already references
                    B.

  **Workaround**    Break circular chains into sequential iterations.
                    Each \"round\" of the circular process becomes a
                    separate transaction that references the previous
                    round\'s output as input.

  **Trade-off**     Increases transaction volume and complexity. What
                    might be a single consolidated view in the ERP
                    becomes multiple linked FORAY transactions.
  ----------------- -----------------------------------------------------

Category 2: Medium-Severity Challenges

These transaction types have proven workarounds but may require
additional implementation effort or result in verbose FORAY structures.

2.1 Non-Monetary and Qualitative Transactions

  ----------------- -----------------------------------------------------
  **Severity**      **MEDIUM**

  **Examples**      Salesforce Cases (support tickets), HR onboarding
                    workflows, quality inspection approvals, document
                    versioning, status-only updates, compliance
                    attestations

  **Challenge**     FORAY\'s Accrual and Anticipation components expect
                    numeric amounts. Transactions without monetary value
                    require special handling.

  **Workaround**    Use estimated_value fields with documented
                    heuristics, or set amounts to 0.00 with descriptive
                    audit_data. The v2.0 Salesforce adapter demonstrates
                    this pattern for Cases.

  **Trade-off**     Estimated values may not reflect true economic
                    impact. Auditors must understand the estimation
                    methodology used.
  ----------------- -----------------------------------------------------

2.2 Iterative Workflow Loops

  ----------------- -----------------------------------------------------
  **Severity**      **MEDIUM**

  **Examples**      Physical inventory counts (count → recount →
                    approve), contract negotiation rounds, approval
                    workflows with rejection loops, iterative budgeting
                    processes

  **Challenge**     FORAY models linear progression (Arrangement →
                    Accrual → Anticipation → Action), not iterative loops
                    that may repeat multiple times before resolution.

  **Workaround**    Create multiple Action iterations with dependency
                    chains. Each iteration references the previous as
                    input and produces output for the next.

  **Trade-off**     Verbose structure (4 Actions vs 1 Resolution event).
                    However, this actually provides better audit trail
                    showing the full iteration history.
  ----------------- -----------------------------------------------------

2.3 Highly Contingent Future States

  ----------------- -----------------------------------------------------
  **Severity**      **MEDIUM**

  **Examples**      Option contracts with multiple exercise scenarios,
                    earnout agreements with 20+ milestone combinations,
                    insurance policies with complex claim triggers,
                    multi-path decision trees

  **Challenge**     While Anticipations support conditions, modeling all
                    possible future state combinations can create
                    exponential growth in component count.

  **Workaround**    Record representative scenarios rather than
                    exhaustive combinations. Use condition hashes that
                    reference off-chain decision logic. Create new
                    Anticipations as conditions crystallize.

  **Trade-off**     Complete scenario modeling happens off-chain. FORAY
                    captures the materialized path, not all theoretical
                    possibilities.
  ----------------- -----------------------------------------------------

2.4 Real-Time Continuous Valuations

  ----------------- -----------------------------------------------------
  **Severity**      **MEDIUM**

  **Examples**      Mark-to-market derivatives portfolios, real-time FX
                    exposure, algorithmic trading positions, continuous
                    NAV calculations, intraday margin calls

  **Challenge**     Values change continuously throughout the day.
                    Anchoring every tick would be impractical and
                    expensive.

  **Workaround**    Anchor at regulatory checkpoints (end-of-day, margin
                    call events, reporting dates). Use oracle references
                    for valuation sources. The RMBS and FX examples
                    demonstrate this pattern.

  **Trade-off**     Intraday movements between anchoring points are not
                    on-chain. This aligns with regulatory practice
                    (T+1/T+2 settlement, daily marks) but may not satisfy
                    high-frequency audit requirements.
  ----------------- -----------------------------------------------------

2.5 GDPR Right to Erasure Conflict

  ----------------- -----------------------------------------------------
  **Severity**      **MEDIUM**

  **Examples**      EU customer data subject to \"right to be
                    forgotten,\" employee personal data after
                    termination, consumer loan records after payoff

  **Challenge**     FORAY\'s immutability is intentional---blockchain
                    anchors cannot be deleted. This creates tension with
                    GDPR Article 17 requirements.

  **Workaround**    Store PII only in off-chain encrypted storage;
                    on-chain contains only salted hashes. Delete the
                    off-chain data and encryption keys to achieve
                    practical erasure while preserving audit hash.

  **Trade-off**     Post-erasure, auditors can verify a transaction
                    existed and wasn\'t tampered with, but cannot recover
                    the original parties. Legal counsel should confirm
                    this meets GDPR requirements.
  ----------------- -----------------------------------------------------

Category 3: Low-Severity Challenges

These represent philosophical differences or minor verbosity issues
rather than functional limitations. Workarounds are straightforward.

3.1 Exploratory vs. Committed States

  ----------------- -----------------------------------------------------
  **Severity**      **LOW**

  **Examples**      Benefits enrollment exploration (PA40 in SAP),
                    shopping cart abandonment, draft quotes, what-if
                    scenarios, budget simulations

  **Challenge**     FORAY records post-facto decisions, not exploratory
                    states. It captures \"what happened\" not \"what
                    might happen.\"

  **Workaround**    Create Arrangements only when commitment occurs, not
                    during exploration. This is actually correct
                    accounting---uncommitted explorations shouldn\'t
                    generate audit records.

  **Assessment**    This is a feature, not a bug. FORAY intentionally
                    avoids cluttering the audit trail with uncommitted
                    scenarios.
  ----------------- -----------------------------------------------------

3.2 System-Generated Transactions Without Parties

  ----------------- -----------------------------------------------------
  **Severity**      **LOW**

  **Examples**      Automated depreciation runs, scheduled batch jobs,
                    system maintenance entries, automated reconciliation
                    postings

  **Challenge**     FORAY expects parties in Arrangements.
                    System-generated transactions may not have natural
                    counterparties.

  **Workaround**    Use \"SYSTEM\" or process identifiers as party
                    references. The depreciation-v41.json example
                    demonstrates Accrual-only transactions that bypass
                    Arrangements entirely.

  **Assessment**    v4.1 flexible entry points specifically address
                    this---Accrual-only transactions are now valid.
  ----------------- -----------------------------------------------------

3.3 Date Ranges Instead of Point-in-Time

  ----------------- -----------------------------------------------------
  **Severity**      **LOW**

  **Examples**      Service periods (\"January 2026\"), insurance
                    coverage periods, subscription billing cycles,
                    project phases without exact end dates

  **Challenge**     FORAY datetime fields expect ISO 8601 timestamps.
                    Service periods spanning multiple days require
                    representation.

  **Workaround**    Use period_start/period_end fields in audit_data, or
                    anchor at period boundaries (start timestamp and end
                    timestamp as separate components).

  **Assessment**    This is standard practice---even ERP systems store
                    periods as start/end dates rather than ranges.
  ----------------- -----------------------------------------------------

3.4 Complex Reversal and Correction Patterns

  ----------------- -----------------------------------------------------
  **Severity**      **LOW**

  **Examples**      Prior period adjustments, retroactive restatements,
                    error corrections that affect closed periods,
                    cascading reversals

  **Challenge**     FORAY\'s immutability means original transactions
                    cannot be modified. Corrections must reference and
                    adjust rather than overwrite.

  **Workaround**    Create reversal/correction transactions that
                    reference the original transaction_id. This provides
                    complete audit trail showing both the error and
                    correction.

  **Assessment**    This is actually superior to ERP \"in-place\"
                    corrections---auditors can see both versions and
                    understand what changed.
  ----------------- -----------------------------------------------------

Successfully Handled Transaction Types

For completeness, here are complex transaction types that FORAY handles
exceptionally well, contrary to what might be expected:

-   RMBS Securitizations --- Multi-tranche waterfalls with credit
    enhancement model cleanly in the 4-component structure

-   Cross-Currency Interest Rate Swaps --- Dual currency legs with
    mark-to-market and collateral posting

-   Manufacturing Work Orders --- BOM rollups, labor allocation,
    overhead absorption, WIP tracking

-   Multi-Party Batch Payments --- One payment clearing multiple
    invoices across multiple vendors

-   Cross-Border Energy PPAs --- Multi-currency, multi-jurisdiction
    power purchase agreements

-   Supply Chain Provenance --- Product authentication with
    spectroscopic analysis and chain-of-custody

-   Overnight Repo Transactions --- Secured financing with Treasury
    collateral and tri-party custody

-   Syndicated Loan Facilities --- Multi-bank participation with
    commitment fees and variable interest

Conclusions and Recommendations

FORAY Protocol v4.1 demonstrates robust coverage across enterprise
transaction types. The 12 challenging categories identified all have
functional workarounds, and none represent fundamental
incompatibilities.

Key Findings

1.  No transaction type is unsupported --- All categories have
    documented workarounds

2.  High-frequency streaming data requires batching --- IoT and
    telemetry need aggregation strategies

3.  Probabilistic processes live off-chain --- ML matching, scoring, and
    inference happen outside FORAY

4.  GDPR erasure requires architectural planning --- PII isolation in
    off-chain storage is essential

5.  v4.1 flexible entry points eliminate most structural constraints ---
    Most edge cases from v4.0 are resolved

Implementation Guidance

Organizations implementing FORAY should review their transaction
portfolio against this analysis during the planning phase. High-severity
categories warrant architectural discussion with integration teams.
Medium and low-severity items can typically be addressed during adapter
development without fundamental changes.

Contact

**Author:** Marvin Percival

**Email:** marvinp@dunin7.com

**GitHub:**
[github.com/DUNIN7/foray-kaspathon](https://github.com/DUNIN7/foray-kaspathon)

Disclaimer

*This document describes potential challenges based on theoretical
analysis and known ERP transaction patterns. Actual implementation
complexity may vary. Organizations should conduct their own assessment
based on their specific transaction portfolio and regulatory
requirements.*

*FORAY Protocol --- Transparent audits, protected secrets*

Copyright © 2026 Marvin Percival. All rights reserved.
